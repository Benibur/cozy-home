// Generated by CoffeeScript 1.9.1
var allSlug, americano, byApps, imageByDate;

americano = require('americano-cozy');

byApps = function() {
  if (doc.type === 'persistent') {
    return emit([doc.app, doc.ref], doc);
  }
};

allSlug = function() {
  return emit(doc.slug, doc);
};

imageByDate = function(doc) {
  var ref;
  if (doc["class"] === "image" && (((ref = doc.binary) != null ? ref.file : void 0) != null)) {
    return emit(doc.lastModification, doc);
  }
};

module.exports = {
  user: {
    all: americano.defaultRequests.all
  },
  alarm: {
    all: americano.defaultRequests.all
  },
  event: {
    all: americano.defaultRequests.all
  },
  cozyinstance: {
    all: americano.defaultRequests.all
  },
  notification: {
    all: function(doc) {
      return emit(doc.publishDate, doc);
    },
    byApps: byApps
  },
  application: {
    all: americano.defaultRequests.all,
    bySlug: allSlug
  },
  stack_application: {
    all: americano.defaultRequests.all
  },
  file: {
    imageByDate: imageByDate,
    imageByMonth: {
      map: function(doc) {
        var d, ref;
        if (doc["class"] === "image" && (((ref = doc.binary) != null ? ref.file : void 0) != null)) {
          d = new Date(doc.lastModification);
          return emit([d.getFullYear(), d.getMonth() + 1, d.getDate()], doc._id);
        }
      },
      reduce: '_count'
    }
  }
};
